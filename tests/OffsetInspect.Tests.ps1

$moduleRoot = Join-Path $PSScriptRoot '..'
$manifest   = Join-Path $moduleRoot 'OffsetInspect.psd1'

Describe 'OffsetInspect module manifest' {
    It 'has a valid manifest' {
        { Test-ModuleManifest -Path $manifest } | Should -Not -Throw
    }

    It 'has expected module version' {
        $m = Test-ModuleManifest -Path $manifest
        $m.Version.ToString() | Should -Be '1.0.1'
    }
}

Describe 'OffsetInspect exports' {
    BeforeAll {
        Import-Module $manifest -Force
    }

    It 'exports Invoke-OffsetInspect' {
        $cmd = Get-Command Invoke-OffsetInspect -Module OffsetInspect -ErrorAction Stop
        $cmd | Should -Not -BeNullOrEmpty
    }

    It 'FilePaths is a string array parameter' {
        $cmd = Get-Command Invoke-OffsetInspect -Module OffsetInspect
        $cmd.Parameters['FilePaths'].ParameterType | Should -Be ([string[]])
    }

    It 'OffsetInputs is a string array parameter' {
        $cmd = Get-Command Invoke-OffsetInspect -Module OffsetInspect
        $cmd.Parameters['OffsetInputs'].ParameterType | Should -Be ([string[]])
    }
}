# tests/OffsetInspect.Tests.ps1

$moduleRoot = Join-Path $PSScriptRoot '..'
$manifest   = Join-Path $moduleRoot 'OffsetInspect.psd1'

Describe 'OffsetInspect module manifest' {
    It 'has a valid manifest' {
        { Test-ModuleManifest -Path $manifest } | Should -Not -Throw
    }

    It 'has expected module version' {
        $m = Test-ModuleManifest -Path $manifest
        $m.Version.ToString() | Should -Be '1.0.1'
    }
}

Describe 'OffsetInspect exports' {
    BeforeAll {
        Import-Module $manifest -Force
    }

    It 'exports Invoke-OffsetInspect' {
        $cmd = Get-Command Invoke-OffsetInspect -Module OffsetInspect -ErrorAction Stop
        $cmd | Should -Not -BeNullOrEmpty
    }

    It 'FilePaths is a string array parameter' {
        $cmd = Get-Command Invoke-OffsetInspect -Module OffsetInspect
        $cmd.Parameters['FilePaths'].ParameterType | Should -Be ([string[]])
    }

    It 'OffsetInputs is a string array parameter' {
        $cmd = Get-Command Invoke-OffsetInspect -Module OffsetInspect
        $cmd.Parameters['OffsetInputs'].ParameterType | Should -Be ([string[]])
    }
}